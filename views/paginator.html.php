<?php defined("SYSPATH") or die("No direct script access.");/** * Grey Dragon Theme - a custom theme for Gallery 3 * This theme was designed and built by Serguei Dosyukov, whose blog you will find at http://blog.dragonsoft.us * Copyright (C) 2009-2012 Serguei Dosyukov * * This program is free software; you can redistribute it and/or modify it under the terms of the GNU General * Public License as published by the Free Software Foundation; either version 2 of the License, or (at your * option) any later version. * * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the * implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License * for more details. * * You should have received a copy of the GNU General Public License along with this program; if not, write to * the Free Software Foundation, Inc., 51 Franklin Street - Fifth Floor, Boston, MA  02110-1301, USA. */?><?// This is a generic paginator for album, photo and movie pages.  Depending on the page type,// there are different sets of variables available.  With this data, you can make a paginator// that lets you say "You're viewing photo 5 of 35", or "You're viewing photos 10 - 18 of 37"// for album views.//// Available variables for all page types://   $page_type               - "collection", "item", or "other"//   $page_subtype            - "album", "movie", "photo", "tag", etc.//   $previous_page_url       - the url to the previous page, if there is one//   $next_page_url           - the url to the next page, if there is one//   $total                   - the total number of photos in this album//// Available for the "collection" page types://   $page                    - what page number we're on//   $max_pages               - the maximum page number//   $page_size               - the page size//   $first_page_url          - the url to the first page, or null if we're on the first page//   $last_page_url           - the url to the last page, or null if we're on the last page//   $first_visible_position  - the position number of the first visible photo on this page//   $last_visible_position   - the position number of the last visible photo on this page//// Available for "item" page types://   $position                - the position number of this photo//?><?### FRIENDLY URLS FOR PAGINATION #### Version C# http://www.milesjcarter.co.uk/blog/photos-on-the-web/gallery-3-seo-part-perfect-url-scheme/#CONVERT TO FRIENDLY FORMAT#$pattern = '/\?page=([0-9]+)/';$replacement = 'page/$1/';#REMOVE REDUNDANT /PAGE/1"$pattern2 = '/\/page\/1\b/';$replacement2 = '';#PREVIOUS PAGE#if (isset($previous_page_url)){$previous_page_url = preg_replace($pattern, $replacement, $previous_page_url);$previous_page_url = preg_replace($pattern2, $replacement2, $previous_page_url);}#NEXT PAGE#if (isset($next_page_url)) {$next_page_url = preg_replace($pattern, $replacement, $next_page_url);}#FIRST PAGE#if (isset($first_page_url)) {$first_page_url = preg_replace($pattern, $replacement, $first_page_url);$first_page_url = preg_replace($pattern2, $replacement2, $first_page_url);}#LAST PAGE#if (isset($last_page_url)){$last_page_url = preg_replace($pattern, $replacement, $last_page_url);}?><?  $_pagelist = array();  switch ($page_type) {    case "collection":      if (isset($item)):        $parent = $item->parent();      endif;      $current_page = $page;      $total_pages = $max_pages;      // Prepare page url list      for ($i = 1; $i <= $total_pages; $i++):        $_pagelist[$i] = url::site(url::merge(array("page" => $i)));      endfor;      break;    case "item":      if (isset($item)):        $parent = $item->parent();      endif;      if (isset($position)):        $current_page = $position;       else:        $current_page = 1;      endif;      $total_pages = $total;      if (isset($parent)):        $siblings = $parent->children();        for ($i = 1; $i <= $total; $i++):          $_pagelist[$i] = $siblings[$i-1]->url();        endfor;      endif;      break;    default:      $current_page = 1;      $total_pages = 1;      $_pagelist[1] = url::site();      break;  }  if ($total_pages <= 1):    $pagination_msg = "";  else:    $pagination_msg = "";    if ($total_pages < 13):      for ($i = 1; $i <= $total_pages; $i++):        if ($i == $current_page):          $pagination_msg .= '<li class="active"><a>' . t($i) . '<span class="sr-only">&#40;current&#41;</span></a></li>';        else:                                                                          $pagination_msg .= '<li><a href="' . $_pagelist[$i] . '" title="' . t("Page") . ' ' . t($i) . '">' . t($i) . '</a></li>';        endif;        if ($i < $total_pages):          $pagination_msg .= '';         endif;      endfor;    elseif ($current_page < 9):      for ($i = 1; $i <= 10; $i++):        if ($i == $current_page):           $pagination_msg .= '<li class="active"><a>' . t($i) . '<span class="sr-only">&#40;current&#41;</span></a></li>';        else:          $pagination_msg .= '<li><a href="' . $_pagelist[$i] . '" title="' . t("Page") . ' ' . t($i) . '">' . t($i) . '</a></li>';        endif;        if ($i < 10):          $pagination_msg .= '';         endif;      endfor;            $pagination_msg .= '<li class="disabled"><a>&hellip;</a></li>';      $pagination_msg .= '<li><a href="' . $_pagelist[$total_pages - 1] . '" title="' . t("Page") . ' ' . t($total_pages - 1) . '">' . t($total_pages - 1) . '</a></li>';      $pagination_msg .= '';      $pagination_msg .= '<li><a href="' . $_pagelist[$total_pages] . '" title="' . t("Page") . ' ' . t($total_pages) . '">' . t($total_pages) . '</a></li>';    elseif ($current_page > $total_pages - 8):      $pagination_msg .= '<li><a href="' . $_pagelist[1] . '" title="' . t("Page") . ' ' . t(1) . '">' . t(1) . '</a></li>';      $pagination_msg .= '';      $pagination_msg .= '<li><a href="' . $_pagelist[2] . '" title="' . t("Page") . ' ' . t(2) . '">' . t(2) . '</a></li>';      $pagination_msg .= '<li class="disabled"><a>&hellip;</a></li>';      for ($i = $total_pages - 9; $i <= $total_pages; $i++):        if ($i == $current_page):           $pagination_msg .= '<li class="active"><a>' . t($i) . '<span class="sr-only">&#40;current&#41;</span></a></li>';        else:          $pagination_msg .= '<li><a href="' . $_pagelist[$i] . '" title="' . t("Page") . ' ' . t($i) . '">' . t($i) . '</a></li>';        endif;        if ($i < $total_pages):          $pagination_msg .= '';        endif;      endfor;    else:      $pagination_msg .= '<li><a href="' . $_pagelist[1] . '" title="' . t("Page") . ' ' . t(1) . '">' . t(1) . '</a></li>';      $pagination_msg .= '';      $pagination_msg .= '<li><a href="' . $_pagelist[2] . '" title="' . t("Page") . ' ' . t(2) . '">' . t(2) . '</a></li>';      $pagination_msg .= '<li class="disabled"><a>&hellip;</a></li>';      for ($i = $current_page - 5; $i <= $current_page + 5; $i++):        if ($i == $current_page):           $pagination_msg .= '<li class="active"><a>' . t($i) . '<span class="sr-only">&#40;current&#41;</span></a></li>';        else:          $pagination_msg .= '<li><a href="' . $_pagelist[$i] . '" title="' . t("Page") . ' ' . t($i) . '">' . t($i) . '</a></li>';        endif;        if ($i < $current_page + 5):          $pagination_msg .= '';        endif;      endfor;      $pagination_msg .= '<li class="disabled"><a>&hellip;</a></li>';      $pagination_msg .= '<li><a href="' . $_pagelist[$total_pages - 1] . '" title="' . t("Page") . ' ' . t($total_pages - 1) . '">' . t($total_pages - 1) . '</a></li>';      $pagination_msg .= '';      $pagination_msg .= '<li><a href="' . $_pagelist[$total_pages] . '" title="' . t("Page") . ' ' . t($total_pages) . '">' . t($total_pages) . '</a></li>';    endif;  endif; ?><div style="clear: both;"></div><div class="row">  <nav>    <ul class="pagination hidden-sm hidden-xs">    <?= $pagination_msg ?>    </ul>    <div class="btn-group aR" role="group" aria-label="Paginator">    <? if ($current_page > 1): ?>      <a title="<?= t("first") ?>" id="g-navi-first" class="btn btn-default" href="<?= $_pagelist[1] ?>"><span class="glyphicon glyphicon-backward" aria-hidden="true"></span></a>    <? else: ?>      <button type="button" class="btn btn-default disabled" aria-label="<?= t("first") ?>"><span class="glyphicon glyphicon-backward" aria-hidden="true"></span></button>    <? endif ?>      <? if (isset($previous_page_url)): ?>      <a title="<?= t("previous") ?>" id="g-navi-prev" class="btn btn-default" href="<?= $previous_page_url ?>"><span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span></a>    <? else: ?>      <button type="button" class="btn btn-default disabled" aria-label="<?= t("previous") ?>"><span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span></button>    <? endif ?>      <? if (isset($parent)): ?>      <a title="<?= t("up") ?>" id="g-navi-parent" class="btn btn-default" href="<?= $parent->url("show={$item->id}"); ?>"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span></a>    <? else: ?>      <button type="button" class="btn btn-default disabled" aria-label="<?= t("up") ?>"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span></button>    <? endif ?>      <? if (isset($next_page_url)): ?>      <a title="<?= t("next") ?>" class="btn btn-default ui-right" id="g-navi-next" href="<?= $next_page_url ?>"><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span></a>    <? else: ?>      <button type="button" class="btn btn-default disabled" aria-label="<?= t("next") ?>"><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span></button>    <? endif ?>      <? if ($current_page < $total_pages): ?>        <a title="<?= t("last") ?>" class="btn btn-default ui-right" id="g-navi-last" href="<?= $_pagelist[$total_pages] ?>"><span class="glyphicon glyphicon-forward" aria-hidden="true"></span></a>    <? else: ?>      <button type="button" class="btn btn-default disabled" aria-label="<?= t("last") ?>"><span class="glyphicon glyphicon-forward" aria-hidden="true"></span></button>    <? endif ?>  </div></nav></div>